---
layout: post
title: Install and Running Picrust2
categories: [notes]
tags: [python]
---

# Installation

I tried to install picrust2 following the [instructions](https://github.com/picrust/picrust2/wiki/Installation) they provided. Both the `Install from bioconda` and `Install from source` gave the same error:

	No module named 'conda._vendor.auxlib'
	
	
This is an error due to old version of [mamba](https://github.com/mamba-org/mamba/issues/1583), a solution was also provided there.

	$ conda create -y -n newenv "python=3.8" "mamba>=0.22.1"
	$ conda activate newenv
	
Now let's try install from bioconda again. 

	(newenv)$ mamba create -n picrust2 -c bioconda -c conda-forge picrust2=2.5.0

I ran into downloading problem, which as solved by scientific internet surfing (ke xue shang wang).

Now let's activate this environment

	(newenv)$ mamba activate picrust2
	Run 'mamba init' to be able to run mamba activate/deactivate 
	and start a new shell session. Or use conda to activate/deactivate.
	(newenv)$ mamba init
	
Close current terminal and start a new one.

	(base)$ mamba activate picrust2
	(picrust2)$ picrust2_pipeline -h
	
# Running

## Input


- fasta of amplicon sequences variants (study_seqs.fna)
- biom table of the abundance of each ASV across each sample (study_seqs.biom). I don't have this. A tab-delimited table with ASV ids as the first column and sample abundances as all subsequent columns will also work. I will use the latter.


## Options

--stratified: Flag to indicate that stratified tables should be generated at all steps, this can greatly increase run-time
 
 
## Run

	(picrust2)$ picrust2_pipeline.py -s test_rep.fna -i test_otu_table_total.txt -o test_picrust2 -p 12
	Warning - column named "taxonomy" in abundance table - if this corresponds to taxonomic labels this should be removed before running this pipeline.

OK removed. 

	$ cut -f 1-27 test_otu_table_total.txt > test.otu_table_total.txt
	$ picrust2_pipeline.py -s test_rep.fna -i test.otu_table_total.txt -o test_picrust2 -p 12
	Error: 
 
 

